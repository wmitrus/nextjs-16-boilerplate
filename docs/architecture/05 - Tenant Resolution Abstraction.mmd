flowchart LR
%% Traceability: src/core/contracts/tenancy.ts, src/modules/auth/infrastructure/ClerkTenantResolver.ts
%% Runtime anchors: src/security/core/security-context.ts, src/security/middleware/with-auth.ts, src/security/core/authorization-facade.ts

IDENTITY["Identity"]
TENANT_RESOLVER["TenantResolver (Contract)"]
TENANT_CTX["TenantContext"]
AUTH_INFRA["Auth module adapter"]
SEC_CTX["security-context"]
AUTHZ["AuthorizationFacade / AuthorizationService"]

AUTH_INFRA --> TENANT_RESOLVER
IDENTITY --> TENANT_RESOLVER
TENANT_RESOLVER --> TENANT_CTX
TENANT_CTX --> SEC_CTX
SEC_CTX --> AUTHZ