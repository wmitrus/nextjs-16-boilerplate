# GitHub Rulesets Configuration

## 1. Main Branch Protection (`main`)

**Target Branches**: `main`

### Rules:

- **Restrict Pushes**: Only allow pushes via Pull Requests.
- **Require Pull Request Reviews**:
  - Required number of approvals: 1
  - Dismiss stale pull request approvals when new commits are pushed.
  - Require review from Code Owners (if `CODEOWNERS` file exists).
- **Require Status Checks to Pass**:
  - `pr-validation` (to be implemented in Step 2)
  - `chromatic` (existing)
  - `Vercel Preview` (to be implemented in Step 3)
- **Require Signed Commits**: Optional but recommended for enterprise.
- **Require Linear History**: Prevent merge commits (prefer squash or rebase).
- **Prevent Force Pushes**: Default for protected branches.
- **Prevent Deletions**: Default for protected branches.

## 2. Governance Rules

### PR from Main

- **Constraint**: Prevent PRs where the source branch is `main`.
- **Implementation**: This is typically handled by GitHub Actions or a custom ruleset metadata check if supported. Since standard rulesets focus on _target_ branches, we will enforce this via `pr-validation` workflow logic.

### Branch Naming Convention (Optional but recommended)

- `feature/*`
- `fix/*`
- `hotfix/*`
- `chore/*`
- `refactor/*`

## 3. Required Status Checks (Summary)

| Check           | Source         | Purpose                                                 |
| --------------- | -------------- | ------------------------------------------------------- |
| `pr-validation` | GitHub Actions | Lint, Typecheck, Unit Tests, Circular Deps, Unused Deps |
| `chromatic`     | Chromatic      | Visual Regression Testing                               |
| `Vercel`        | Vercel         | Preview Deployment                                      |
| `security-scan` | GitHub Actions | Secret scanning & Dependency vulnerabilities            |

## 4. Local Protections (Husky)

Already implemented in the project via:

- `pre-commit`: `lint-staged`
- `pre-push`: `typecheck`, `skott`, `depcheck`, `madge`, `env:check`
